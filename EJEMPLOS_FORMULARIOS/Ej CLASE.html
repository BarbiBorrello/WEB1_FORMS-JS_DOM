<!DOCTYPE html>
<html>

<head>
    <title>Ejercicio Simulacro</title>
    <link href="https://fonts.googleapis.com/css2?family=EB+Garamond&display=swap" rel="stylesheet">
    <link
        href="https://fonts.googleapis.com/css2?family=Noto+Serif&family=Nunito:ital,wght@1,200&family=Roboto:ital,wght@0,300;1,100;1,300&display=swap"
        rel="stylesheet">

    <style>
        body {
            font-family: Roboto;
        }

        form {
            display: flex;
            flex-direction: column;
            gap: 10px;
            padding: 30px;
            margin: 10px;
            border: 5px solid blue;
            border-radius: 15px;
        }

        textarea {
            border: 1px solid black;
            border-radius: 0px 15px 0px 15px;
        }

        #errores {
            border: 1px solid red;
            padding: 5px;
            display: none;
        }

        #errores p {
            color: red;
        }

        .error {
            border: 1px solid red;
        }
    </style>

</head>
<!--
    Crear un formulario con:
        Nombre (obligatorio)
        Mensaje (obligatorio, máximo 200 caracteres)
        Email (opcional, pero válido si lo ingresa)
    Dar estilo particular al formulario
    Validar campos
    Mostrar lista con errores creando elementos del DOM
    Cambiar estilo a campos con errores
    Al enviar, si los datos está bien, agregar mensaje a una lista de mensajes, con el siguiente formato:
    Si proveyó el email,
    “<nombre> dice <mensaje>. Contacto: <email>.”
    Si no,
    “<nombre> dice <mensaje>.”
    Limpiar los campos, errores de validación y cambios de estilo
    Hacer foco en el primer input al iniciar el documento y luego de cada envío correcto
-->

<body>
    <h1>Ejercicio Simulacro</h1>
    <form onsubmit="return validar()" id="f_contacto">
        <label for="f_nombre">Nombre</label>
        <input id="f_nombre" autofocus />
        <label for="f_mensaje">Mensaje</label>
        <textarea id="f_mensaje" rows="3"></textarea>
        <label for="f_email">Email</label>
        <input id="f_email" />
        <button type="submit">Enviar</button>
        <div id="errores">
        </div>
    </form>

    <div id="mensajes">
    </div>


    <script>

        let primero = document.querySelector("form input");  // FOCO EN EL PRIMER ELEMENTO
        primero.focus(); // FOCO EN EL PRIMER ELEMENTO
        let reg_correo = /^\w+([.-]?\w+)*@\w+([.-]?\w+)*(\.\w{2,})+$/; //PATRON

        function validar() {
            //VARIABLES //
            let f_nombre = document.querySelector("#f_nombre"); // recupero elemento
            f_nombre.classList.remove("error"); // si esta ok remuevo error?

            let f_mensaje = document.querySelector("#f_mensaje");
            f_mensaje.classList.remove("error");

            let f_email = document.querySelector("#f_email");
            f_email.classList.remove("error");

            let lta_errores = document.querySelector("#errores"); // recupero errores
            lta_errores.innerHTML = ""; // la lista de errores comiezo vacia

            lta_errores.style.display = "none"; // lista de errores escondida

            let lta_mensajes = document.querySelector("#mensajes"); //lista de ambos tipos de mensajes
            let hubo_error = false; // si hay error  no se envia



//VALIDACON NOMBRE//
            if (f_nombre.value == "") {
                f_nombre.classList.add("error");
                let p = document.createElement("p"); // crear mensaje
                p.innerHTML = "Falta el nombre"; // contenido del mensaje
                lta_errores.appendChild(p); // agregar a la lista de errores
                hubo_error = true; // si hay error
            }


//VALIDACON MENSAJES//            
            if (f_mensaje.value == "") {
                f_mensaje.classList.add("error");
                let p = document.createElement("p");
                p.innerHTML = "Falta el mensaje";
                lta_errores.appendChild(p);
                hubo_error = true;
            } else if (f_mensaje.value.length > 200) {
                f_mensaje.classList.add("error");
                let p = document.createElement("p");
                p.innerHTML = "Longitud máxima del mensaje: 200";
                lta_errores.appendChild(p);
                hubo_error = true;


//VALIDACON MAIL// 
            }
            if (f_email.value != "" && !reg_correo.test(f_email.value)) {
                //if(!/^([a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+\.[a-zA-Z0-9-.]+)?$/.test(f_email.value)){
                f_email.classList.add("error");
                let p = document.createElement("p");
                p.innerHTML = "Email inválido";
                lta_errores.appendChild(p);
                hubo_error = true;
            }


//VALIDACON MENSAJES DE ERRROR Y  OK// 
            if (hubo_error) {//
                lta_errores.style.display = "initial";
                return false; // si hay error se vuelve al comienzo para cargar datos de nuevo
            } else { // sino
                let p = document.createElement("p");
                if (f_email.value != "") {
                    p.innerHTML =
                        f_nombre.value + " dice " +
                        f_mensaje.value + ". Contacto: " +
                        f_email.value + ".";
                } else {
                    p.innerHTML =
                        f_nombre.value + " dice " +
                        f_mensaje.value + ".";
                }


                lta_mensajes.appendChild(p);

                document.forms["f_contacto"].reset(); // se resetea formulario para hacer una nueva carga de datos.


                 // foco en el primer elemento
                let primero = document.querySelector("form input");
                primero.focus(); 
            }


            return false;
        }









    </script>
</body>

</html>